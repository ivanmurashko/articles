%% -*- coding:utf-8 -*- 
\documentclass[14pt,a4paper]{article} 

\usepackage[utf8]{inputenc}
\usepackage{minted}
\usepackage{longtable}
\usepackage{hyperref}
\hypersetup{
  pdftex,
  allcolors=blue,
  bookmarksnumbered=true,     
  bookmarksopen=true,         
  bookmarksopenlevel=1,       
  colorlinks=true,            
  pdfstartview=Fit,           
  pdfpagemode=UseOutlines,  
  pdfpagelayout=TwoPageRight,
  pdftitle={STL sort},
  pdfsubject={STL sort},
  pdfauthor={Ivan Murashk–æ},
  pdfkeywords={STL, C++, quick sort}
}

\title{STL sort}
\author{Murashko Ivan}
\date{}
\begin{document}

\maketitle

\section*{Introduction}
The most tricky thing in C++ is an error catch. Most part of errors
are located in the application level and you can be quite sure that
the library, especially the well known STL, is error free. But what
should you do if your application code is trivial i.e. seems to be
error free but you got a SIGSEGV inside a system library. Most
probably you just felt into a situation that is described in the
article. 

The examples in the article uses gcc 5.5.0 from the docker image
gcc:5: 
\begin{minted}{shell}
$ docker run gcc:5 gcc --version
gcc (GCC) 5.5.0
\end{minted}


\section{Example}
Lets look at the following code:
\inputminted{c++}{./src/sort.cpp}
What's output does it produces? One can expect the following one:
\begin{minted}{shell}
$ ./src/sort
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
$
\end{minted}
i.e. the original array has to be displayed. In reality the following
output is produced by gcc 5.5.0 
\begin{minted}{shell}
$ ./src/sort
0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
$
\end{minted}
As one can see the array is broken. How it can be if every
function in the code snapshot seems to be correct? The answer is
below. 

\section{STL requirements}

The STL library states the following requirements for std::sort 
\cite{ISO:2013:IIP}(pp. 897-898): the compare function must follow so
called strict weak ordering requirement. Especially it
says that 
\begin{minted}{c++}
comp(x, x) == true;
\end{minted}
The requirement is violated
by the $\le$ operand used in our example.  

Why the requirement is so important?

\section*{Conclusion}
TBD

\bibliographystyle{gost780s}  
\bibliography{cppsort}     


\end{document}
