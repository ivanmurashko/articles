%% -*- coding:utf-8 -*- 
\subsection{ Реализация базовых элементов алгоритма Гровера}

\subsubsection{Инверсия фазы}
Каким образом может быть реализована инверсия фазы: как выглядит
квантовый логический элемент который осуществляет преобразование
(\ref{eqQuantCompGroverUxast}), т. е. каким образом $f\left(x\right)$
может быть ``послано'' в фазу?

\input ./part4/quantcomp/figgroverphaseinvimpl.tex

Рассмотрим схему изображенную на
рис. (\ref{figQuantCompGroverPhaseInvImpl}). Предложенная схема
осуществляет следующее преобразование:
\begin{equation}
\left|x\right>\otimes\left|b\right> \rightarrow 
\left|x\right>\otimes\left|b\otimes f\left(x\right)\right>.
\nonumber
\end{equation}

Для случая $\left|b\right> = \left|-\right> = 
\frac{\left|0\right> - \left|1\right>}{\sqrt{2}}$ имеем
\begin{eqnarray}
\left|x\right>\otimes\left|-\right> \rightarrow 
\left|x\right>\otimes\left(\frac{\left|0\otimes 0\right> -
  \left|1\otimes 0\right>}{\sqrt{2}}\right) = 
\nonumber \\
= \left|x\right>\otimes\left(\frac{\left|0\right> -
  \left|1\right>}{\sqrt{2}}\right) =
\left|x\right>\otimes\left|-\right>
, x \ne x^{\ast},
\nonumber \\
\left|x\right>\otimes\left|-\right> \rightarrow 
\left|x\right>\otimes\left(\frac{\left|0\otimes 1\right> -
  \left|1\otimes 1\right>}{\sqrt{2}}\right) = 
\nonumber \\
= \left|x\right>\otimes\left(\frac{\left|1\right> -
  \left|0\right>}{\sqrt{2}}\right) =
- \left|x\right>\otimes\left|-\right>
, x = x^{\ast},
\nonumber
\end{eqnarray}
т. о. мы имеем следующее преобразование
\begin{equation}
\left|x\right>\otimes\left|-\right> \rightarrow 
\left(-1\right)^{f\left(x\right)}\left|x\right>\otimes\left|-\right>.
\label{eqQuantCompGroverPhaseInvImpl}
\end{equation}

\subsubsection{Обращение относительно среднего}

\input ./part4/quantcomp/figgrovermeaninvimpl.tex

Рассмотрим схему изображенную на
рис. (\ref{figQuantCompGroverMeanInvImpl}). Элемент $\hat{U}_{x \ne 0}$
осуществляет преобразование аналогичное
(\ref{eqQuantCompGroverPhaseInvImpl}) при этом функция
$f\left(x\right) = 0$, при $x = 0$ и $f\left(x\right) = 1$, при $x \ne
0$, т. о.
\begin{eqnarray}
\hat{U}_{x \ne 0} \left|x\right>\otimes\left|-\right> 
= \left|x\right>\otimes\left|-\right>, x = 0,
\nonumber \\
\hat{U}_{x \ne 0} \left|x\right>\otimes\left|-\right> 
= - \left|x\right>\otimes\left|-\right>, x \ne 0,
\nonumber
\end{eqnarray}
т. е. матрица преобразования выглядит следующим образом
\begin{eqnarray}
\hat{U}_{x \ne 0} = 
\begin{pmatrix}
1 \otimes \left|-\right> & 0 & 0 & \cdots & 0 \\
0 & -1 \otimes \left|-\right>  & 0 & \cdots & 0 \\
0 & 0 & -1 \otimes \left|-\right>   & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 0 & 0  & \cdots & -1 \otimes \left|-\right>  \\
\end{pmatrix}
=
\nonumber \\
=
\left\{
\begin{pmatrix}
2  & 0 & 0 & \cdots & 0 \\
0 & 0 & 0 & \cdots & 0 \\
0 & 0 & 0 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 0 & 0  & \cdots & 0 \\
\end{pmatrix} - 
\begin{pmatrix}
1 & 0 & 0 & \cdots & 0 \\
0 & 1 & 0 & \cdots & 0 \\
0 & 0 & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 0 & 0  & \cdots & 1  \\
\end{pmatrix}
\right\}
\otimes \left|-\right> 
. 
\nonumber
\end{eqnarray}

Объединяя этот результат с двумя преобразованиями Адамара получаем:
\begin{eqnarray}
\hat{H}^{\otimes n}
\left\{
\begin{pmatrix}
2  & 0 & 0 & \cdots & 0 \\
0 & 0 & 0 & \cdots & 0 \\
0 & 0 & 0 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 0 & 0  & \cdots & 0 \\
\end{pmatrix} - 
\begin{pmatrix}
1 & 0 & 0 & \cdots & 0 \\
0 & 1 & 0 & \cdots & 0 \\
0 & 0 & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 0 & 0  & \cdots & 1  \\
\end{pmatrix}
\right\}
\otimes \left|-\right>
\hat{H}^{\otimes n}
=
\nonumber \\
=
\left\{
\hat{H}^{\otimes n}
\begin{pmatrix}
2  & 0 & 0 & \cdots & 0 \\
0 & 0 & 0 & \cdots & 0 \\
0 & 0 & 0 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 0 & 0  & \cdots & 0 \\
\end{pmatrix}
\hat{H}^{\otimes n}
- \hat{H}^{\otimes n} \hat{I} \hat{H}^{\otimes n}
\right\}
\otimes \left|-\right>
 = 
\nonumber \\
=
\left\{
\begin{pmatrix}
\frac{2}{N}  & \frac{2}{N} & \frac{2}{N} & \cdots & \frac{2}{N} \\
\frac{2}{N} & \frac{2}{N} & \frac{2}{N} & \cdots & \frac{2}{N} \\
\frac{2}{N} & \frac{2}{N} & \frac{2}{N} & \cdots & \frac{2}{N} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
\frac{2}{N} & \frac{2}{N} & \frac{2}{N} & \cdots & \frac{2}{N} \\
\end{pmatrix} - \hat{I}
\right\}
\otimes \left|-\right>
=
\nonumber \\
=
\left\{
\begin{pmatrix}
\frac{2}{N} - 1  & \frac{2}{N} & \frac{2}{N} & \cdots & \frac{2}{N} \\
\frac{2}{N} & \frac{2}{N} - 1 & \frac{2}{N} & \cdots & \frac{2}{N} \\
\frac{2}{N} & \frac{2}{N} & \frac{2}{N} - 1 & \cdots & \frac{2}{N} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
\frac{2}{N} & \frac{2}{N} & \frac{2}{N} & \cdots & \frac{2}{N} - 1\\
\end{pmatrix}
\right\}
\otimes \left|-\right>.
\label{eqQuantCompGroverMeanInvImpl}
\end{eqnarray}

Если воздействовать оператором $\hat{H}^{\otimes n}\hat{U}_{x \ne
  0}\hat{H}^{\otimes n}$, то используя результат
(\ref{eqQuantCompGroverMeanInvImpl}) получим:
\begin{eqnarray}
\hat{H}^{\otimes n}\hat{U}_{x \ne
  0}\hat{H}^{\otimes n} \sum_x \alpha_x \left| x \right> = 
\nonumber \\
=
\begin{pmatrix}
\frac{2}{N} - 1  & \frac{2}{N} & \frac{2}{N} & \cdots & \frac{2}{N} \\
\frac{2}{N} & \frac{2}{N} - 1 & \frac{2}{N} & \cdots & \frac{2}{N} \\
\frac{2}{N} & \frac{2}{N} & \frac{2}{N} - 1 & \cdots & \frac{2}{N} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
\frac{2}{N} & \frac{2}{N} & \frac{2}{N} & \cdots & \frac{2}{N} - 1\\
\end{pmatrix}
\begin{pmatrix}
\alpha_0 \\
\alpha_1 \\
\alpha_2 \\
\vdots \\
\alpha_{N - 1} \\
\end{pmatrix}
=
\nonumber \\
=
\begin{pmatrix}
\frac{2}{N}\sum_x\alpha_x - \alpha_0\\
\frac{2}{N}\sum_x\alpha_x - \alpha_1\\
\frac{2}{N}\sum_x\alpha_x - \alpha_2\\
\vdots \\
\frac{2}{N}\sum_x\alpha_x - \alpha_{N-1}\\
\end{pmatrix} = 
\sum_x \left(2 \mathcal{M} - \alpha_x \right)\left| x \right>.
\nonumber
\end{eqnarray}
Т. о. схема предложенная на рис. (\ref{figQuantCompGroverMeanInvImpl})
действительно осуществляет обращение относительно среднего.
