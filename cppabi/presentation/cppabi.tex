\documentclass{beamer}

\usepackage{url}
\usepackage{minted}
\usepackage{upquote}
\usepackage{graphicx}
\usepackage{color}
\usepackage{longtable}
\usepackage[nott]{inconsolata}

\usepackage{mathptmx}
\usepackage{helvet}

\definecolor{rcorange}{rgb}{0.99, 0.69, 0.24}
\definecolor{rcblue}{rgb}{0.45, 0.62, 0.81}
\definecolor{tocblue}{rgb}{0.13, 0.29, 0.53}

\mode<presentation>
{
\usetheme{CambridgeUS}
\usecolortheme{seahorse}
\setbeamercolor*{palette primary}{use=structure, fg=black, bg=rcblue}
\setbeamercolor*{palette secondary}{use=structure, fg=black, bg=rcblue}
\setbeamercolor*{palette tertiary}{use=structure, fg=black, bg=rcorange}
\setbeamercolor*{palette quaternary}{use=structure, fg=black, bg=rcorange}
}

%\definecolor{scriptbg}{rgb}{0.95,0.95,0.95}
\definecolor{scriptbg}{rgb}{0.99,0.96,0.90}
\definecolor{hlfg}{HTML}{FE9A2E}
\definecolor{links}{HTML}{2A1B81}
\hypersetup{colorlinks,linkcolor=,urlcolor=links}

\usepackage[T2A]{fontenc}
%\usepackage{lmodern}
\usepackage[utf8x]{inputenc}
\usepackage[english,russian]{babel}
\logo{\includegraphics[height=0.4cm]{RingCentral-logo-256x.png}}
\title[CPP ABI]
    {cpp abi}
\author{routers@core}
\date{16 May 2018}

\newcommand{\SurrLgt}[1]{\textless{}#1\textgreater{}}
\newcommand{\Hl}[1]{\textcolor{hlfg}{\textbf{#1}}}

\setlength{\parskip}{4pt}

\setbeamercovered{transparent=10}

\setbeamertemplate{section in toc}
{
\begingroup
\color{tocblue}
\inserttocsection
\endgroup
}
\addtobeamertemplate{title page}{}{\tableofcontents}

\begin{document}
\maketitle

\section{API vs ABI}

\begin{frame}[fragile]
\frametitle{API}
Aplication Program Interface - compilation (компиляция)
\end{frame}

\begin{frame}[fragile]
\frametitle{ABI}
Aplication Binary Interface - linker (компоновка)
\end{frame}

\section{gcc 5.1 ABI}

\begin{frame}[fragile]
\frametitle{Поддержка стандарта c++11 в gcc}
\begin{itemize}
\item ver. 4.8.1 - объявлена полная поддержка стандарта c++11
\item ver. 5.1 - объявлены серьезные изменения в ABI
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\frametitle{Sizes}
\begin{minted}{c++}
int main() {
  std::vector<int> v;
  std::cout << "std::vector: " << sizeof(v) << std::endl;  
  ...
  std::string str;
  std::cout << "std::string: " << sizeof(str) << std::endl;  
  return 0;
}
\end{minted}
\end{frame}

\begin{frame}[fragile]
\frametitle{Sizes}
\begin{longtable}{|l|c|c|}
\hline
Контейнер STL & gcc 4.9.4 & gcc 5.5.0 \\
\hline
std::vector & 24 & 24 \\
std::queue & 80 & 80 \\
std::priority\_queue & 32 & 32 \\
std::deque & 80 & 80 \\
std::stack & 80 & 80 \\
std::set & 48 & 48 \\
std::multiset & 48 & 48 \\
std::map & 48 & 48 \\
std::multimap & 48 & 48 \\
std::list & 16 & 24 \\
std::string & 8 & 32 \\
\hline
\end{longtable}
\end{frame}

\begin{frame}[fragile]
\frametitle{std::list}
\begin{itemize}
\item 16 bytes - двусвязанный список
\item Вычисление размера требует $O(N)$ операций
\item Стандарт C++11 требует для этой операции $O(1)$
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\frametitle{std::string}
\inputminted{c++}{../src/str.cpp}
\end{frame}

\begin{frame}[fragile]
\frametitle{gcc 5.1 std::string}
\begin{minted}{shell}
$ ./str5
0x7ffd1b434d90
0x7ffd1b434de0
$
\end{minted}
\end{frame}

\begin{frame}[fragile]
\frametitle{gcc 4.9.4 std::string}
\begin{minted}{shell}
$ ./str4
0x127fe88
0x127fe88
$
\end{minted}
\end{frame}


\begin{frame}[fragile]
\frametitle{COW}
\begin{itemize}
\item Преймущества - скорость
\item Недобстатки - падение производительности при работе в
  многопоточном окружении
\item COW vs C++11 move
\end{itemize}
\end{frame}


\section{Бинарные внешние библиотеки}

\section{Примеры}

\section{Заключение}

\begin{frame}[fragile]
\frametitle{Frame 1}
\begin{itemize}
\item<+-> Чистый функциональный язык, тип \emph{Monad} скрывает побочные эффекты
        \begin{minted}[fontsize=\tiny,bgcolor=scriptbg,linenos=false,gobble=2]{c++}
          std::string a;
        \end{minted}
\item<+-> TBD
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\frametitle{ABI}
\begin{itemize}
\item<+-> TBD
\item<+-> TBD
\end{itemize}
\end{frame}

\section{ABI}

\begin{frame}[fragile]
\frametitle{ABI 1}
Исходный код 
\begin{minted}[fontsize=\tiny,bgcolor=scriptbg,linenos=false,gobble=2]{c++}
  std::string a;
\end{minted}
\end{frame}

\end{document}

